cmake_minimum_required(VERSION 3.5)

project(@GIT_DEP_NAME@ NONE)

include(ExternalProject)

set(FETCH_BASE_DIR "@CMAKE_BINARY_DIR@/_deps" CACHE PATH "Directory under which to collect all populated content")

ExternalProject_Add(@GIT_DEP_NAME@_project
  #TMP_DIR      "${FETCH_BASE_DIR}/@NAME_LOWER@-tmp"
  #STAMP_DIR    "${FETCH_BASE_DIR}/@NAME_LOWER@-stamp"
  #DOWNLOAD_DIR "${FETCH_BASE_DIR}/@NAME_LOWER@-download"
  SOURCE_DIR    "${FETCH_BASE_DIR}/@NAME_LOWER@-src"
  BINARY_DIR    "${FETCH_BASE_DIR}/@NAME_LOWER@-build"

  GIT_REPOSITORY "@GIT_DEP_REPOSITORY@"
  
  @TAG_CMD@
  LOG_DOWNLOAD FALSE

  # UPDATE_COMMAND ""
  LOG_UPDATE FALSE

  @PATCH_CMD@
  #LOG_PATCH FALSE

  # CONFIGURE_COMMAND ""
  CMAKE_ARGS
    -DCMAKE_C_COMPILER=@CMAKE_C_COMPILER@
    -DCMAKE_CXX_COMPILER=@CMAKE_CXX_COMPILER@
    -DCMAKE_PREFIX_PATH=@CMAKE_CURRENT_BINARY_DIR@/install
    -DCMAKE_MODULE_PATH=@CMAKE_CURRENT_SOURCE_DIR@/cmake_modules
    -DCMAKE_INSTALL_PREFIX=@CMAKE_CURRENT_BINARY_DIR@/install
    -DCMAKE_INSTALL_LIBDIR=lib
    -DCMAKE_INSTALL_INCLUDEDIR=include
    -DCMAKE_INSTALL_BINDIR=bin
    -DCMAKE_BUILD_TYPE=@CMAKE_BUILD_TYPE@
    -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON
    -DBUILD_SHARED_LIBS=OFF
    -DBUILD_TESTING=OFF
    @ADDITIONAL_ARGS@
  
  LOG_CONFIGURE FALSE
  
  @SUBDIR_CMD@
  
  # BUILD_COMMAND ""
  LOG_BUILD FALSE

  # INSTALL_COMMAND ""
  LOG_INSTALL FALSE

  TEST_COMMAND ""
  LOG_TEST FALSE
)